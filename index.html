<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×¨×›×ª ×”×¢×¨×›×” DRM - ×’×¨×¡×” ××¢×•×“×›× ×ª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Assistant', sans-serif; 
            background: linear-gradient(135deg, #fdf2f8 0%, #f5f3ff 100%); 
        }
        .hidden { display: none; }
        .slide-container {
            width: 100%;
            max-width: 1000px;
            min-height: 600px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 3rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.05);
            border: 2px solid white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 3rem;
            position: relative;
            overflow: hidden;
        }
        .joy-bg {
            background-image: radial-gradient(#ec4899 0.5px, transparent 0.5px);
            background-size: 30px 30px;
            position: absolute;
            inset: 0;
            opacity: 0.1;
            pointer-events: none;
        }
        .word-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }
        .animate-pop { animation: bounceIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .btn-primary {
            background: linear-gradient(to right, #6366f1, #a855f7);
            color: white;
            box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.4);
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 20px -3px rgba(99, 102, 241, 0.5);
        }
        .btn-disabled {
            background: #e2e8f0;
            color: #94a3b8;
            cursor: not-allowed;
            box-shadow: none;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6 text-right text-slate-800">

    <!-- SCREEN 1: User ID -->
    <div id="screen-id" class="slide-container">
        <div class="joy-bg"></div>
        <div class="text-center mb-8 relative">
            <h1 class="text-5xl font-black bg-gradient-to-l from-indigo-600 to-pink-500 bg-clip-text text-transparent mb-2">×‘×¨×•×›×™× ×”×‘××™×!</h1>
            <p class="text-slate-500 font-bold text-lg">××¢×¨×›×ª ×”×¢×¨×›×” DRM ×§×•×’× ×™×˜×™×‘×™×ª</p>
        </div>
        <div class="max-w-md mx-auto w-full space-y-6 relative">
            <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-pink-100">
                <label class="block text-sm font-black text-indigo-900 mb-3 text-lg">××¨×‘×¢×ª ×”×¡×¤×¨×•×ª ×©×œ ××¡×¤×¨ ×”×¡×œ×•×œ××¨×™ ×©×œ×š</label>
                <input type="text" id="input-subject-code" placeholder="×”×§×œ×™×“×• ×›××Ÿ ××ª ×”×§×•×“ ×©×œ×›×" class="w-full p-4 bg-indigo-50/50 border-2 border-transparent rounded-2xl font-bold text-center text-xl focus:border-indigo-400 focus:bg-white outline-none transition-all">
            </div>
            <button onclick="saveID()" class="w-full btn-primary font-black py-5 rounded-3xl text-xl transition-all"> ×§×“×™××”, ×‘×•××• × ×ª×—×™×œ! </button>
        </div>
    </div>

    <!-- SCREEN 1.5: Test Structure Explanation -->
    <div id="screen-structure" class="slide-container hidden">
        <div class="joy-bg"></div>
        <div class="text-center mb-8">
            <h2 class="text-4xl font-black text-indigo-900 mb-4">××™×š ×–×” ×¢×•×‘×“?</h2>
        </div>
        <div class="max-w-2xl mx-auto space-y-6 text-xl leading-relaxed text-slate-700 font-bold bg-white/50 p-8 rounded-[2rem]">
            <p class="flex items-center gap-4">
                <span class="bg-indigo-100 text-indigo-600 w-10 h-10 rounded-full flex items-center justify-center shrink-0">1</span>
                <span>× ×¦×™×’ ×œ×›× <span class="text-indigo-600 underline">13 ××™×œ×™×</span> ×œ××©×š ×“×§×” ××—×ª ×‘×œ×‘×“.</span>
            </p>
            <p class="flex items-center gap-4">
                <span class="bg-pink-100 text-pink-600 w-10 h-10 rounded-full flex items-center justify-center shrink-0">2</span>
                <span>×œ××—×¨ ××›×Ÿ, × ×‘×¦×¢ ××‘×—×Ÿ ×©×œ <span class="text-pink-600">30 ×©× ×™×•×ª</span>.</span>
            </p>
            <p class="flex items-center gap-4">
                <span class="bg-emerald-100 text-emerald-600 w-10 h-10 rounded-full flex items-center justify-center shrink-0">3</span>
                <span>×”×©×ª××©×• ×‘<b>×—×¦×™×</b> ×‘××§×œ×“×ª ×›×“×™ ×œ×‘×—×•×¨ ××ª ×”××™×œ×” ×”× ×›×•× ×”.</span>
            </p>
        </div>
        <button onclick="startMemoCounter()" class="max-w-md mx-auto w-full mt-10 btn-primary font-black py-5 rounded-3xl text-xl transition-all"> ×”×‘× ×ª×™, ×× ×™ ××•×›×Ÿ/×” ×œ×©× ×Ÿ </button>
    </div>

    <!-- SCREEN 2: Memorization -->
    <div id="screen-memo" class="slide-container hidden">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-black text-indigo-900 mb-2">×–××Ÿ ×©×™× ×•×Ÿ!</h2>
            <div id="memo-timer" class="text-5xl font-black text-pink-500 mt-2 bg-pink-50 inline-block px-8 py-2 rounded-full border-2 border-pink-100">60</div>
        </div>
        <div class="bg-gradient-to-br from-indigo-50 to-pink-50 p-8 rounded-[3rem] border-2 border-white max-w-2xl mx-auto w-full shadow-inner">
            <div id="word-list-display" class="grid grid-cols-3 gap-4"></div>
        </div>
        <div class="text-center mt-8">
            <button onclick="finishMemo()" class="text-indigo-400 hover:text-indigo-600 font-bold underline transition-colors">×¡×™×™××ª×™ ×œ×©× ×Ÿ ×œ×¤× ×™ ×”×–××Ÿ</button>
        </div>
    </div>

    <!-- SCREEN 3: Status & Choice -->
    <div id="screen-choice" class="slide-container hidden">
        <div class="text-center mb-10">
            <h2 class="text-4xl font-black text-indigo-900 mb-4">×‘×—×™×¨×ª ××¦×‘ ××‘×—×Ÿ</h2>
            <p id="completion-msg" class="text-emerald-600 font-black hidden text-xl">âœ¨ ×”×©×œ××ª ××ª ×©× ×™ ×—×œ×§×™ ×”××‘×—×Ÿ! ×ª×•×“×” ×¨×‘×”. âœ¨</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-3xl mx-auto w-full">
            <div class="bg-white border-4 border-amber-50 p-8 rounded-[2.5rem] flex flex-col items-center text-center shadow-sm">
                <div class="bg-amber-100 text-amber-600 w-16 h-16 rounded-full flex items-center justify-center text-3xl mb-4">ğŸ’¡</div>
                <h3 class="text-2xl font-black mb-2">×ª×¨×’×•×œ</h3>
                <button onclick="setStatusAndStart(true)" class="w-full bg-amber-400 hover:bg-amber-500 text-white font-black py-4 rounded-2xl shadow-md transition-all">×”×ª×—×œ ×ª×¨×’×•×œ</button>
            </div>
            <div class="bg-white border-4 border-indigo-50 p-8 rounded-[2.5rem] flex flex-col items-center text-center shadow-sm">
                <div class="bg-indigo-100 text-indigo-600 w-16 h-16 rounded-full flex items-center justify-center text-3xl mb-4">ğŸš€</div>
                <h3 class="text-2xl font-black mb-6">××‘×—×Ÿ</h3>
                <div class="flex flex-col gap-3 w-full">
                    <button id="btn-normal" onclick="setStatusAndStart(false, false)" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-black py-4 rounded-2xl shadow-md transition-all">××¦×‘ ×¨×’×™×œ âœ¨</button>
                    <button id="btn-influence" onclick="setStatusAndStart(false, true)" class="w-full bg-rose-500 hover:bg-rose-600 text-white font-black py-4 rounded-2xl shadow-md transition-all">××—×¨×™ ×¦×¨×™×›×” ğŸ§ª</button>
                </div>
            </div>
        </div>
    </div>

    <!-- SCREEN 4: Game -->
    <div id="screen-game" class="slide-container hidden !p-0 border-none !bg-slate-900 overflow-hidden">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_#1e1b4b_0%,_#0f172a_100%)] opacity-100"></div>
        <div class="absolute top-8 left-8 right-8 flex justify-between items-center z-10">
            <div id="hud-stats" class="bg-white/10 backdrop-blur-md px-6 py-2 rounded-full font-black text-indigo-200 border border-white/10">×“×™×•×§: 0 | RT: 0ms</div>
            <div id="timer-display" class="bg-pink-500 text-white px-6 py-2 rounded-full font-black text-xl shadow-lg">30×©'</div>
        </div>
        <button id="exit-practice-btn" onclick="exitPractice()" class="absolute bottom-10 right-1/2 translate-x-1/2 bg-white/10 backdrop-blur text-white px-8 py-3 rounded-full font-black hover:bg-white/20 transition-all z-50 border border-white/10 hidden">×¡×™×•× ×ª×¨×’×•×œ âœ–</button>
        <div id="toast" class="absolute top-1/4 left-1/2 -translate-x-1/2 px-8 py-3 rounded-2xl font-black text-2xl opacity-0 transition-all z-50 scale-90"></div>
        <div id="targets-wrap" class="flex items-center justify-center gap-24 h-full w-full relative z-10">
            <div id="card-left" class="word-card w-64 h-40 bg-white/5 border-4 border-white/10 rounded-[3rem] flex items-center justify-center text-3xl font-black text-white backdrop-blur-sm"></div>
            <div id="card-right" class="word-card w-64 h-40 bg-white/5 border-4 border-white/10 rounded-[3rem] flex items-center justify-center text-3xl font-black text-white backdrop-blur-sm"></div>
        </div>
    </div>

    <!-- SCREEN 5: Results -->
    <div id="screen-results" class="slide-container hidden text-center">
        <div class="joy-bg"></div>
        <div class="animate-pop">
            <div class="text-6xl mb-6">ğŸ†</div>
            <h2 class="text-4xl font-black text-indigo-900 mb-8">×”×ª×•×¦××•×ª ×©×œ×š</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 max-w-4xl mx-auto">
                <div class="bg-white p-6 rounded-3xl border-2 border-emerald-100 shadow-sm">
                    <div class="text-emerald-500 text-sm font-black mb-2 uppercase">×”×¦×œ×—×•×ª</div>
                    <div id="res-success" class="text-5xl font-black text-slate-800">0</div>
                </div>
                <div class="bg-white p-6 rounded-3xl border-2 border-rose-100 shadow-sm">
                    <div class="text-rose-500 text-sm font-black mb-2 uppercase">×¤×¡×¤×•×¡×™×</div>
                    <div id="res-fail" class="text-5xl font-black text-slate-800">0</div>
                </div>
                <div id="res-card-rt" class="bg-white p-6 rounded-3xl border-2 border-indigo-100 shadow-sm">
                    <div class="text-indigo-500 text-sm font-black mb-2 uppercase">×–××Ÿ ×ª×’×•×‘×”</div>
                    <div id="res-rt" class="text-5xl font-black text-slate-800">0ms</div>
                </div>
            </div>
            <button onclick="nextScreen('screen-choice')" class="max-w-md mx-auto w-full btn-primary py-5 rounded-3xl font-black text-xl transition-all">×—×–×¨×” ×œ××¡×š ×”×‘×—×™×¨×”</button>
        </div>
    </div>

    <script>
        const originalWords = ["×’×©×", "×˜×™×¤×•×ª", "×™×", "×›×•×¡", "× ×—×œ", "×‘×¨×™×›×”", "× ×”×¨", "××’×", "×¨×˜×•×‘", "×©×ª×™×™×”", "×–×¨×", "×©×˜×™×¤×”", "× ×•×–×œ"];
        const wordPairs = [
            {correct: "×’×©×", distractor: "×¢× ×Ÿ"}, {correct: "×˜×™×¤×•×ª", distractor: "×“××¢×•×ª"},
            {correct: "×™×", distractor: "×—×•×£"}, {correct: "×›×•×¡", distractor: "×‘×§×‘×•×§"},
            {correct: "× ×—×œ", distractor: "×•××“×™"}, {correct: "×‘×¨×™×›×”", distractor: "××¦×™×œ"},
            {correct: "× ×”×¨", distractor: "×©×™×˜×¤×•×Ÿ"}, {correct: "××’×", distractor: "×‘×¨×‘×•×¨"},
            {correct: "×¨×˜×•×‘", distractor: "×œ×—"}, {correct: "×©×ª×™×™×”", distractor: "×¦××"},
            {correct: "×–×¨×", distractor: "×—×©××œ"}, {correct: "×©×˜×™×¤×”", distractor: "× ×™×§×™×•×Ÿ"},
            {correct: "× ×•×–×œ", distractor: "××•×¦×§"}
        ];

        let userData = { subjectCode: '', testsCompleted: { normal: false, influence: false } };
        let game = { active: false, practice: false, successes: 0, fails: 0, totalTrials: 0, rt: [], timeLeft: 30, timer: null };
        let memoTimer;

        const listDiv = document.getElementById('word-list-display');
        originalWords.forEach(w => {
            const span = document.createElement('div');
            span.className = "bg-white p-4 rounded-2xl text-center font-black text-indigo-900 border border-indigo-100";
            span.textContent = w;
            listDiv.appendChild(span);
        });

        function nextScreen(id) {
            document.querySelectorAll('.slide-container').forEach(s => s.classList.add('hidden'));
            const target = document.getElementById(id);
            target.classList.remove('hidden');
            target.classList.add('animate-pop');
            if(id === 'screen-choice') updateChoiceUI();
        }

        function saveID() {
            const code = document.getElementById('input-subject-code').value;
            if(!code) return;
            userData.subjectCode = code;
            nextScreen('screen-structure');
        }

        function startMemoCounter() {
            nextScreen('screen-memo');
            let sec = 60;
            memoTimer = setInterval(() => {
                sec--;
                document.getElementById('memo-timer').textContent = sec;
                if(sec <= 0) finishMemo();
            }, 1000);
        }

        function finishMemo() {
            clearInterval(memoTimer);
            nextScreen('screen-choice');
        }

        function updateChoiceUI() {
            const btnN = document.getElementById('btn-normal');
            const btnI = document.getElementById('btn-influence');
            const msg = document.getElementById('completion-msg');

            if (userData.testsCompleted.normal) {
                btnN.classList.add('btn-disabled');
                btnN.disabled = true;
                btnN.textContent = "××¦×‘ ×¨×’×™×œ - ×”×•×©×œ× âœ…";
            }
            if (userData.testsCompleted.influence) {
                btnI.classList.add('btn-disabled');
                btnI.disabled = true;
                btnI.textContent = "××—×¨×™ ×¦×¨×™×›×” - ×”×•×©×œ× âœ…";
            }

            if (userData.testsCompleted.normal && userData.testsCompleted.influence) {
                msg.classList.remove('hidden');
            }
        }

        function setStatusAndStart(practice, influence = false) {
            game = { active: true, practice, successes: 0, fails: 0, totalTrials: 0, rt: [], timeLeft: 30, underInfluence: influence };
            nextScreen('screen-game');
            document.getElementById('exit-practice-btn').classList.toggle('hidden', !practice);
            document.getElementById('timer-display').classList.toggle('hidden', practice);
            updateHUD();
            updateGameStep();
            if (!practice) {
                game.timer = setInterval(() => {
                    game.timeLeft--;
                    document.getElementById('timer-display').textContent = game.timeLeft + '×©\'';
                    if (game.timeLeft <= 0) endGame();
                }, 1000);
            }
        }

        function exitPractice() {
            game.active = false;
            if(game.timer) clearInterval(game.timer);
            nextScreen('screen-choice');
        }

        function updateGameStep() {
            if (!game.active) return;
            const pair = wordPairs[Math.floor(Math.random() * wordPairs.length)];
            const isLeftCorrect = Math.random() > 0.5;
            game.currentStep = { isLeftCorrect, startTime: Date.now() };
            const l = document.getElementById('card-left');
            const r = document.getElementById('card-right');
            l.style.opacity = '0'; r.style.opacity = '0';
            setTimeout(() => {
                l.textContent = isLeftCorrect ? pair.correct : pair.distractor;
                r.textContent = isLeftCorrect ? pair.distractor : pair.correct;
                l.style.opacity = '1'; r.style.opacity = '1';
                l.style.borderColor = r.style.borderColor = 'rgba(255,255,255,0.1)';
            }, 50);
        }

        function handleSelection(selectedLeft) {
            if (!game.active) return;
            const isCorrect = (selectedLeft === game.currentStep.isLeftCorrect);
            const rt = Date.now() - game.currentStep.startTime;
            const card = selectedLeft ? document.getElementById('card-left') : document.getElementById('card-right');
            if (isCorrect) {
                game.successes++; game.rt.push(rt);
                card.style.borderColor = '#10b981';
                showToast(`××¢×•×œ×”! ${rt}ms`, 'success');
            } else {
                game.fails++;
                card.style.borderColor = '#ef4444';
                showToast('×œ× × ×›×•×Ÿ', 'error');
            }
            game.totalTrials++;
            updateHUD();
            setTimeout(updateGameStep, 200);
        }

        function updateHUD() {
            const avg = game.rt.length ? Math.round(game.rt.reduce((a,b)=>a+b)/game.rt.length) : 0;
            document.getElementById('hud-stats').textContent = `×“×™×•×§: ${game.successes}/${game.totalTrials} | RT: ${avg}ms`;
        }

        function showToast(msg, type) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.className = `absolute top-1/4 left-1/2 -translate-x-1/2 px-10 py-4 rounded-3xl font-black text-2xl transition-all z-50 shadow-2xl ${type === 'success' ? 'bg-emerald-500 text-white' : 'bg-rose-500 text-white'}`;
            t.style.opacity = '1';
            t.style.transform = 'translate(-50%, -20px) scale(1)';
            setTimeout(() => { t.style.opacity = '0'; t.style.transform = 'translate(-50%, 0px) scale(0.9)'; }, 600);
        }

        function endGame() {
            game.active = false;
            clearInterval(game.timer);
            if (!game.practice) {
                if (game.underInfluence) userData.testsCompleted.influence = true;
                else userData.testsCompleted.normal = true;
            }
            nextScreen('screen-results');
            document.getElementById('res-success').textContent = game.successes;
            document.getElementById('res-fail').textContent = game.fails;
            const avg = game.rt.length ? Math.round(game.rt.reduce((a,b)=>a+b)/game.rt.length) : 0;
            document.getElementById('res-rt').textContent = avg + 'ms';
        }

        window.onkeydown = (e) => {
            if (!game.active) return;
            if (e.key === 'ArrowLeft') handleSelection(true);
            if (e.key === 'ArrowRight') handleSelection(false);
        };
    </script>
</body>
</html>